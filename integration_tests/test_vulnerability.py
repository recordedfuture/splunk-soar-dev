def test_vulnerability_intelligence(run_action):
    result = run_action("vulnerability intelligence", [{"vulnerability": "CVE-2013-2094"}])
    expected_keys = [
        "cvss",
        "risk",
        "cvssv3",
        "entity",
        "intelCard",
        "mitreTags",
        "aiInsights",
        "timestamps",
        "ai_insights",
        "commonNames",
        "threatLists",
        "nvdDescription",
        "relatedEntities",
        "recordedfutureLinks",
    ]
    assert list(result.keys()) == expected_keys


def test_vulnerability_reputation(run_action):
    result = run_action("vulnerability reputation", [{"vulnerability": "CVE-2013-2094"}])
    expected_keys = [
        "id",
        "name",
        "type",
        "evidence",
        "maxrules",
        "risklevel",
        "riskscore",
        "rulecount",
        "description",
    ]

    assert list(result.keys()) == expected_keys
